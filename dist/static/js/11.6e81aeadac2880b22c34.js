webpackJsonp([11],{"/KTk":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={name:"basetable",data:function(){return{data1:[],data3:[],activePerson:"scheme",activePlatform:"scheme",personnelProps:{label:"name",children:"personnelTypes"},platformProps:{label:"name",children:"platformTypes"},url:"",tableData:[],activeName:1,apiUrl:domain.apiUrl,addVisible:!1,modifyVisible:!1,delVisible:!1,dialogImageUrl:"",dialogVisible:!1,form:{},formAdd:{},idx:-1,loading:!0,totalNum:0,pageSize:10,currentId:0,deleteIdArr:[],rules:{name:[{required:!0,message:"名称不能为空",trigger:"change"}],type:[{required:!0,message:"类型不能为空",trigger:"change"}]},addType:""}},created:function(){this.getData()},components:{},watch:{$route:function(t){"/classify"==t.path&&this.getData()}},computed:{data:function(){return this.tableData}},methods:{handleClick:function(t,e){var a=this;this.data1=[],this.url=this.apiUrl+"/client/api/personnelType/findPage",this.$axios.get(this.url).then(function(e){console.log(e);for(var n=0;n<e.data.content.length;n++)e.data.content[n].type==t.name&&a.data1.push(e.data.content[n])})},handleClickPlatform:function(t,e){var a=this;this.data3=[],this.url=this.apiUrl+"/client/api/platformType/findPage",this.$axios.get(this.url).then(function(e){console.log(e);for(var n=0;n<e.data.content.length;n++)e.data.content[n].type==t.name&&a.data3.push(e.data.content[n])})},append:function(t){var e=this;console.log(t);var a=t.id,n=t.type;this.$prompt("请输入分类名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(i){var o=i.value;e.$axios.post(e.apiUrl+"/client/api/personnelType/add?name="+o+"&pid="+a+"&type"+n).then(function(a){var n={id:a.data.id,name:a.data.name,type:a.data.type,personnelTypes:[]};t.personnelTypes||e.$set(t,"personnelTypes",[]),t.personnelTypes.push(n),e.$message.success("添加成功!")})})},remove:function(t,e){var a=this;console.log(t,e);var n=t.parent,i=n.data.personnelTypes||n.data,o=i.findIndex(function(t){return t.id===e.id}),s=new FormData;s.append("id",e.id),s.append("_method","delete"),this.$axios.post(this.apiUrl+"/client/api/personnelType/deleteById",s).then(function(t){i.splice(o,1),a.$message.success("删除成功！")})},modifyPersonnelType:function(t){var e=this;console.log(t),this.$prompt("请输入修改后的分类名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var n=a.value,i=new FormData;i.append("id",t.id),i.append("_method","PUT"),i.append("name",n),e.$axios.post(e.apiUrl+"/client/api/personnelType/update",i).then(function(a){200==a.status?(e.$message.success("修改成功!"),t.name=n):e.$message.error("修改失败!")})})},appendPlatform:function(t){var e=this;console.log(t);var a=t.id,n=t.type;this.$prompt("请输入分类名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(i){var o=i.value;e.$axios.post(e.apiUrl+"/client/api/platformType/add?name="+o+"&pid="+a+"&type="+n).then(function(a){var n={id:a.data.id,name:a.data.name,type:a.data.type,platformTypes:[]};t.platformTypes||e.$set(t,"platformTypes",[]),t.platformTypes.push(n),e.$message.success("添加成功!"),e.activePlatform=t.type})})},removePlatform:function(t,e){var a=this;console.log(t,e);var n=t.parent,i=n.data.platformTypes||n.data,o=i.findIndex(function(t){return t.id===e.id}),s=new FormData;s.append("id",e.id),s.append("_method","delete"),this.$axios.post(this.apiUrl+"/client/api/platformType/deleteById",s).then(function(t){i.splice(o,1),a.$message.success("删除成功！")})},modifyPlatformType:function(t){var e=this;console.log(t),this.$prompt("请输入修改后的分类名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var n=a.value,i=new FormData;i.append("id",t.id),i.append("_method","PUT"),i.append("name",n),e.$axios.post(e.apiUrl+"/client/api/platformType/update",i).then(function(a){200==a.status?(e.$message.success("修改成功!"),t.name=n):e.$message.error("修改失败!")})})},getData:function(){var t=this;this.data1=[],this.data3=[],this.url=this.apiUrl+"/client/api/personnelType/findPage",this.$axios.get(this.url).then(function(e){console.log(e);for(var a=0;a<e.data.content.length;a++)"scheme"==e.data.content[a].type&&t.data1.push(e.data.content[a]);t.tableData=e.data.content,t.loading=!1}),this.$axios.get(this.apiUrl+"/client/api/platformType/findPage").then(function(e){console.log(e);for(var a=0;a<e.data.content.length;a++)"scheme"==e.data.content[a].type&&t.data3.push(e.data.content[a]);t.loading=!1})},addPerson:function(){this.addVisible=!0,this.addType="person"},addPlatform:function(){this.addVisible=!0,this.addType="platform"},saveAdd:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var a=new FormData,n="";a.append("name",e.formAdd.name),a.append("type",e.formAdd.type),n="person"==e.addType?"/client/api/personnelType/add":"/client/api/platformType/add",e.$axios.post(e.apiUrl+n,a).then(function(t){200==t.status&&(e.$message.success("添加成功!"),"person"==e.addType?(e.activePerson=e.formAdd.type,e.handleClick({name:e.formAdd.type})):(e.activePlatform=e.formAdd.type,e.handleClickPlatform({name:e.formAdd.type})),e.addVisible=!1,e.formAdd={})})}})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-tickets"}),t._v("  分类管理")])],1)],1),t._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"custom-tree-container"},[a("div",{staticClass:"block"},[a("p",{staticClass:"tree-title"},[t._v("人才分类"),a("span",{staticClass:"addBtn",on:{click:t.addPerson}},[t._v("添加")])]),t._v(" "),a("div",{staticClass:"personBox"},[a("el-tabs",{staticStyle:{"margin-top":"20px"},attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activePerson,callback:function(e){t.activePerson=e},expression:"activePerson"}},[a("el-tab-pane",{attrs:{label:"方案",name:"scheme"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"施工图",name:"workingDrawing"}})],1)],1),t._v(" "),a("el-tree",{attrs:{data:t.data1,props:t.personnelProps,"show-checkbox":"","node-key":"id","highlight-current":!0,"expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node,i=e.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[t._v(t._s(i.name))]),t._v(" "),a("span",{staticStyle:{"margin-left":"50px"}},[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:function(){return t.append(i)}}}),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-minus"},on:{click:function(){return t.remove(n,i)}}}),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(e){t.modifyPersonnelType(i)}}})],1)])}}])})],1),t._v(" "),a("div",{staticClass:"block"},[a("p",{staticClass:"tree-title"},[t._v("问题分类"),a("span",{staticClass:"addBtn",on:{click:t.addPlatform}},[t._v("添加")])]),t._v(" "),a("div",{staticClass:"personBox"},[a("el-tabs",{staticStyle:{"margin-top":"20px"},attrs:{type:"card"},on:{"tab-click":t.handleClickPlatform},model:{value:t.activePlatform,callback:function(e){t.activePlatform=e},expression:"activePlatform"}},[a("el-tab-pane",{attrs:{label:"方案",name:"scheme"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"施工图",name:"workingDrawing"}})],1)],1),t._v(" "),a("el-tree",{attrs:{data:t.data3,props:t.platformProps,"show-checkbox":"","node-key":"id","highlight-current":!0,"expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node,i=e.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[t._v(t._s(i.name))]),t._v(" "),a("span",{staticStyle:{"margin-left":"50px"}},[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:function(){return t.appendPlatform(i)}}}),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-minus"},on:{click:function(){return t.removePlatform(n,i)}}}),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(e){t.modifyPlatformType(i)}}})],1)])}}])})],1)])]),t._v(" "),a("el-dialog",{attrs:{title:"添加一级分类",visible:t.addVisible,width:"620px"},on:{"update:visible":function(e){t.addVisible=e}}},[a("el-form",{ref:"formAdd",attrs:{model:t.formAdd,"label-width":"100px",rules:t.rules}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name",width:"200px"}},[a("el-input",{attrs:{placeholder:"请输入分类名称"},model:{value:t.formAdd.name,callback:function(e){t.$set(t.formAdd,"name",e)},expression:"formAdd.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{model:{value:t.formAdd.type,callback:function(e){t.$set(t.formAdd,"type",e)},expression:"formAdd.type"}},[a("el-option",{key:"1",attrs:{label:"方案",value:"scheme"}}),t._v(" "),a("el-option",{key:"2",attrs:{label:"施工图",value:"workingDrawing"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.saveAdd("formAdd")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(n,i,!1,function(t){a("iIVY")},"data-v-2931c657",null);e.default=o.exports},iIVY:function(t,e){}});